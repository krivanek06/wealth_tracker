<!-- account state -->
<ng-container *ngIf="investmentAccount$ | async as investmentAccount; else pageSkeleton">
	<ng-container *ngIf="investmentAccountGrowth$ | async as investmentAccountGrowth; else pageSkeleton">
		<div class="mx-auto mb-4 md:w-10/12">
			<app-investment-account-state
				(cashChangeClickEmitter)="onChangeChangeClick()"
				[investmentAccount]="investmentAccount"
			></app-investment-account-state>
		</div>

		<div class="grid grid-cols-1 gap-4 xl:grid-cols-2">
			<div class="">
				<!-- account growth -->
				<app-investment-account-portfolio-growth-chart
					[investmentAccountGrowth]="investmentAccountGrowth"
				></app-investment-account-portfolio-growth-chart>
			</div>

			<div>TODO - display account balance growth</div>
		</div>

		<!-- period change -->
		<div
			class="grid grid-cols-1 gap-4 p-4 mb-6 sm:grid-cols-2 md:grid-cols-3 xl:flex xl:justify-around sm:max-xl:pl-14"
		>
			<app-investment-account-period-change
				*ngFor="let periodChange of accountPeriodChange$ | async"
				[periodChange]="periodChange"
			></app-investment-account-period-change>
		</div>

		<!-- allocation charts -->
		<div class="grid gap-4 md:grid-cols-2 overflow-x-clip">
			<!-- sector allocation chart -->
			<app-pie-chart class="scale-125" [series]="sectorAllocationChart$ | async"></app-pie-chart>

			<!-- asset allocation chart -->
			<app-pie-chart class="scale-125" [series]="assetAllocationChart$ | async"></app-pie-chart>
		</div>

		<!-- action buttons -->
		<app-investment-account-action-buttons
			[sectorAllocationInputSource]="sectorAllocationInputSource$ | async"
			[formControl]="sectorFormControl"
			(addEmitter)="onAddHolding()"
			(showHistoryEmitter)="onShowHisotry()"
		></app-investment-account-action-buttons>

		<!-- active investments table -->
		<app-investment-account-active-holdings-table
			(holdingClickedEmitter)="onAddHolding($event)"
			[totalInvestedAmount]="totalInvestedAmount$ | async"
			[activeHoldings]="filteredActiveHoldings$ | async"
		></app-investment-account-active-holdings-table>
	</ng-container>
</ng-container>

<ng-template #pageSkeleton>
	<app-investment-account-skeleton></app-investment-account-skeleton>
</ng-template>
