<!-- account state -->
<ng-container *ngIf="investmentAccount$ | async as investmentAccount; else pageSkeleton">
	<div class="w-full px-2 mx-auto mb-4 md:w-10/12">
		<app-investment-account-state
			(cashChangeClickEmitter)="onCashChangeClick()"
			(addHoldingClickEmitter)="onAddHolding()"
			[investmentAccount]="investmentAccount"
		></app-investment-account-state>
	</div>

	<ng-container>
		<!-- portfolio change chart -->
		<app-investment-account-portfolio-growth
			*ngIf="investmentAccountGrowth$ | async as investmentAccountGrowth; else portfolioChartSkeleton"
			[investmentAccountGrowth]="investmentAccountGrowth"
		></app-investment-account-portfolio-growth>

		<!-- period change -->
		<div
			class="grid grid-cols-1 gap-4 p-4 mt-6 md:mb-10 sm:grid-cols-2 md:grid-cols-3 xl:flex xl:justify-around sm:max-xl:pl-14"
		>
			<app-investment-account-period-change
				*ngFor="let periodChange of accountPeriodChange$ | async"
				[periodChange]="periodChange"
			></app-investment-account-period-change>
		</div>

		<!-- allocation charts -->
		<div class="grid gap-4 mb-6 lg:grid-cols-2 overflow-x-clip">
			<!-- sector allocation chart -->
			<app-pie-chart class="hidden scale-125 lg:block" [series]="sectorAllocationChart$ | async"></app-pie-chart>

			<!-- asset allocation chart -->
			<app-pie-chart class="md:scale-125" [series]="assetAllocationChart$ | async"></app-pie-chart>
		</div>

		<!-- action buttons -->
		<app-investment-account-action-buttons
			[sectorAllocationInputSource]="sectorAllocationInputSource$ | async"
			[formControl]="sectorFormControl"
			(addEmitter)="onAddHolding()"
			(showHistoryEmitter)="onShowHisotry()"
		></app-investment-account-action-buttons>

		<!-- active investments table -->
		<app-investment-account-active-holdings-table
			(holdingClickedEmitter)="onAddHolding($event)"
			[totalInvestedAmount]="totalInvestedAmount$ | async"
			[activeHoldings]="filteredActiveHoldings$ | async"
		></app-investment-account-active-holdings-table>
	</ng-container>
</ng-container>

<!-- skeleton -->
<ng-template #pageSkeleton>
	<app-investment-account-skeleton></app-investment-account-skeleton>
</ng-template>

<!-- portfolio chart skeleton -->
<ng-template #portfolioChartSkeleton>
	<div class="h-[550px] g-skeleton"></div>
</ng-template>
