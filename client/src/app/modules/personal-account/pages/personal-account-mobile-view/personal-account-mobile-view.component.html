<!-- account info -->
<div class="mb-6">
	<app-personal-account-account-state
		[accountState]="accountDisplayedState$ | async"
	></app-personal-account-account-state>
</div>

<!-- expense chart -->
<ng-container *ngIf="accountDisplayedState$ | async as accountState">
	<div class="-mt-8">
		<app-personal-account-tag-allocation-chart
			[series]="personalAccountDailyExpensePieChart$ | async"
			[accountBalance]="accountState.total"
		></app-personal-account-tag-allocation-chart>
	</div>
</ng-container>

<mat-divider></mat-divider>

<!-- action button to add new entry -->
<div class="w-full h-12 mt-4 mb-1">
	<button (click)="onDailyEntryClick(null)" mat-stroked-button type="button" color="primary" class="w-full">
		<mat-icon>add</mat-icon>
		Add daily entry
	</button>
</div>

<mat-divider></mat-divider>

<!-- table filter -->
<div class="mt-3">
	<ng-container [formGroup]="filterDailyDataGroup">
		<app-form-mat-input-wrapper
			inputCaption="Filter by date"
			controlName="dateFilter"
			inputType="SELECT_SOURCE_WRAPPER"
			[inputSourceWrapper]="filterDateInputSourceWrapper$ | async"
		></app-form-mat-input-wrapper>
	</ng-container>
</div>

<!-- title & show history checkbox -->
<app-personal-account-display-toggle
	[formControl]="showHistoryFormControl"
	[selectedTag]="personalAccountBasic | getTagById: filterDailyDataGroup.controls.selectedTagIds.value[0] | async"
></app-personal-account-display-toggle>

<!-- tag aggregation -->
<ng-container *ngIf="accountTagAggregationForTimePeriod$ | async as aggregations">
	<app-personal-account-expenses-by-tag
		*ngIf="!showHistoryFormControl.value"
		[formControl]="filterDailyDataGroup.controls.selectedTagIds"
		[aggregations]="aggregations"
		[multiple]="false"
	></app-personal-account-expenses-by-tag>
</ng-container>

<!-- historical data -->
<ng-container *ngIf="dailyDataAggregation$ | async as dailyDataAggregation">
	<app-personal-account-daily-entries-table-mobile
		*ngIf="showHistoryFormControl.value"
		[personalAccountDailyData]="dailyDataAggregation"
		(editDailyEntryClickEmitter)="onDailyEntryClick($event)"
	></app-personal-account-daily-entries-table-mobile>
</ng-container>
