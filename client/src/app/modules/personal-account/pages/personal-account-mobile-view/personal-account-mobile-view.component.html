<ng-container *ngIf="personalAccountDetails$ | async as personalAccountDetails; else showSkeleton">
	<!-- account info -->
	<div *ngIf="accountDisplayedState$ | async as accountDisplayedState" class="mb-6">
		<app-personal-account-account-state [accountState]="accountDisplayedState"></app-personal-account-account-state>
	</div>

	<!-- expense chart -->
	<div class="-mt-8">
		<app-pie-chart
			class="scale-110"
			[series]="personalAccountDailyExpensePieChart$ | async"
			[displayValue]="(accountDisplayedState$ | async)?.total"
		></app-pie-chart>
	</div>

	<!-- settings -->
	<div class="relative z-10 flex justify-start mb-4 -mt-4">
		<app-personal-account-action-buttons
			displayType="menu"
			(buttonClickEmitter)="onActionButtonClick($event)"
		></app-personal-account-action-buttons>
	</div>

	<div class="my-4">
		<mat-divider></mat-divider>
	</div>

	<!-- date filter control -->
	<app-personal-account-daily-entries-filter
		(addDailyEntryClickEmitter)="onDailyEntryClick(null)"
		[formControl]="filterDailyDataGroup.controls.dateFilter"
		[personalAccountDetails]="personalAccountDetails"
	></app-personal-account-daily-entries-filter>

	<!-- title & show history checkbox -->
	<div class="mt-2 mb-6">
		<app-personal-account-display-toggle
			[formControl]="showHistoryFormControl"
			[selectedTag]="(filterDailyDataGroup.controls.selectedTagIds.value[0] | getTagById)  | async"
		></app-personal-account-display-toggle>
	</div>

	<!-- tag aggregation -->
	<ng-container *ngIf="accountTagAggregationForTimePeriod$ | async as accountTagAggregationForTimePeriod">
		<app-personal-account-expenses-by-tag
			*ngIf="!showHistoryFormControl.value"
			[formControl]="filterDailyDataGroup.controls.selectedTagIds"
			[aggregations]="accountTagAggregationForTimePeriod"
			[multiple]="false"
		></app-personal-account-expenses-by-tag>
	</ng-container>

	<!-- historical data -->
	<ng-container *ngIf="dailyDataAggregation$ | async as dailyDataAggregation">
		<app-personal-account-daily-entries-table-mobile
			*ngIf="showHistoryFormControl.value"
			[personalAccountDailyData]="dailyDataAggregation"
			(editDailyEntryClickEmitter)="onDailyEntryClick($event)"
		></app-personal-account-daily-entries-table-mobile>
	</ng-container>
</ng-container>

<!-- skeleton -->
<ng-template #showSkeleton>
	<app-personal-account-mobile-view-skeleton></app-personal-account-mobile-view-skeleton>
</ng-template>
